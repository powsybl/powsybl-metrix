# powsybl-metrix

[![Actions Status](https://github.com/powsybl/powsybl-metrix/workflows/CI/badge.svg)](https://github.com/powsybl/powsybl-metrix/actions)
[![Coverage Status](https://coveralls.io/repos/github/powsybl/powsybl-metrix/badge.svg?branch=master)](https://coveralls.io/github/powsybl/powsybl-metrix?branch=master)
[![Coverage Status](https://sonarcloud.io/api/project_badges/measure?project=com.powsybl%3Apowsybl-metrix&metric=coverage)](https://sonarcloud.io/component_measures?id=com.powsybl%3Apowsybl-metrix&metric=coverage)
[![Quality Gate](https://sonarcloud.io/api/project_badges/measure?project=com.powsybl%3Apowsybl-metrix&metric=alert_status)](https://sonarcloud.io/dashboard?id=com.powsybl%3Apowsybl-metrix)
[![MPL-2.0 License](https://img.shields.io/badge/license-MPL_2.0-blue.svg)](https://www.mozilla.org/en-US/MPL/2.0/)
[![Join the community on Spectrum](https://withspectrum.github.io/badge/badge.svg)](https://spectrum.chat/powsybl)

This module is based on powsybl-core network modeling and framework.\
It provides two main tools : MappingTool and MetrixTool\
It can also be used as a library to integrate its functionalities
into java applications.

The MappingTool provide a mapping configuration from csv timeseries to network.
This configuration allows to generate iidm network at specified time. Furthermore,
it allows using the second tool, MetrixTool.

MetrixTool can compute power load flow and optimal power load flow for the multi variant
networks generated by the mapping tool. Its output are completed by synthesis. 

## Install

Run `./install.sh`

## Usage

`itools mapping` and `itools metrix` are the command line tools that are provided to use and test the mapping and metrix.
Their respective usage is detailed in the following sections.\
For more advanced and intensive usage it is recommended to embedded this package as a library as the time series storage is not optimized.
[Powsybl AFS](https://github.com/powsybl/powsybl-afs) can be use for that matter.  

### Mapping

itools mapping
```text
usage: itools [OPTIONS] mapping --case-file <FILE>
       [--check-equipment-time-series] [--check-versions
       <VERSION1,VERSION2,...>] [--equipment-time-series-dir <DIR>]
       [--first-variant <COUNT>] [--help] [--ignore-empty-filter]
       [--ignore-limits] --mapping-file <FILE> [--mapping-status-file <FILE>]
       [--mapping-synthesis-dir <DIR>] [--max-variant-count <COUNT>]
       [--network-output-dir <DIR>] --time-series <FILE1,FILE2,...>

Available options are:
    --config-name <CONFIG_NAME>   Override configuration file name

Available arguments are:
    --case-file <FILE>                         the case to which times series
                                               will be mapped
    --check-equipment-time-series              check equipment level time series
                                               consistency
    --check-versions <VERSION1,VERSION2,...>   version list to check, all if
                                               option is not set
    --equipment-time-series-dir <DIR>          output directory to store
                                               equipment level time series
    --first-variant <COUNT>                    first variant to simulate
    --help                                     display the help and quit
    --ignore-empty-filter                      ignore empty filter with non zero
                                               time series value
    --ignore-limits                            ignore generator limits
    --mapping-file <FILE>                      Groovy DSL file that describes
                                               the mapping
    --mapping-status-file <FILE>               check mapping status of each time
                                               series of the DB and write result
                                               to the file
    --mapping-synthesis-dir <DIR>              output directory to write mapping
                                               synthesis files
    --max-variant-count <COUNT>                maximum number of variants
                                               simulated
    --network-output-dir <DIR>                 output directory to write IIDM
                                               networks
    --time-series <FILE1,FILE2,...>            time series csv list
```

### Metrix

itools metrix
```text
usage: itools [OPTIONS] metrix --case-file <FILE> [--chunk-size <SIZE>]
       [--contingencies-file <FILE>] [--csv-results-file <FILE>]
       [--first-variant <NUM>] [--help] [--ignore-empty-filter]
       [--ignore-limits] [--log-archive <FILE>] --mapping-file <FILE>
       [--metrix-dsl-file <FILE>] [--remedial-actions-file <FILE>] --time-series
       <FILE1,FILE2,...> [--variant-count <COUNT>] --versions <NUM1,NUM2,...>

Available options are:
    --config-name <CONFIG_NAME>   Override configuration file name

Available arguments are:
    --case-file <FILE>                the base case file
    --chunk-size <SIZE>               chunk size
    --contingencies-file <FILE>       Groovy DSL file that describes
                                      contingencies
    --csv-results-file <FILE>         CSV file results
    --first-variant <NUM>             first variant to simulate
    --help                            display the help and quit
    --ignore-empty-filter             ignore empty filter with non zero time
                                      series value
    --ignore-limits                   ignore generator limits
    --log-archive <FILE>              name of gzip file containing execution
                                      logs
    --mapping-file <FILE>             Groovy DSL file that describes the mapping
    --metrix-dsl-file <FILE>          Groovy DSL file that describes the branch
                                      monitoring and the phase shifter actions
    --remedial-actions-file <FILE>    Name of the remedial actions file
    --time-series <FILE1,FILE2,...>   time series csv list
    --variant-count <COUNT>           number of variants simulated
    --versions <NUM1,NUM2,...>        time series versions
```

## Examples

TP 6 noeuds